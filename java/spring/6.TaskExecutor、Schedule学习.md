# TaskExecutro、Schedule学习
- 关键配置类
    ```java
    // 生成ThreadPoolTaskExecutor
    public class TaskExecutionAutoConfiguration {}
    // 生成 ThreadPoolTaskScheduler
    public class TaskSchedulingAutoConfiguration {}

    // 引入BeanPostProcessor: AsyncAnnotationBeanPostProcessor
    @Import(AsyncConfigurationSelector.class)
    public @interface EnableAsync {}

    // 引入BeanPostProcessor: ScheduledAnnotationBeanPostProcessor
    @Import(SchedulingConfiguration.class)
    public @interface EnableScheduling {}
    // 委托ScheduledTaskRegistrar实现任务注册
    public class ScheduledAnnotationBeanPostProcessor {}
    // 实际对定时任务的管理
    public class ScheduledTaskRegistrar implements ScheduledTaskHolder, InitializingBean, DisposableBean {
        public ScheduledTask scheduleCronTask(CronTask task) {
            ScheduledTask scheduledTask = this.unresolvedTasks.remove(task);
            boolean newTask = false;
            if (scheduledTask == null) {
                scheduledTask = new ScheduledTask(task);
                newTask = true;
            }
            if (this.taskScheduler != null) {
                scheduledTask.future = this.taskScheduler.schedule(task.getRunnable(), task.getTrigger());
            }
            else {
                addCronTask(task);
                this.unresolvedTasks.put(task, scheduledTask);
            }
            return (newTask ? scheduledTask : null);
        }

    }
    // 自定义定时器设置
    public interface SchedulingConfigurer {
        void configureTasks(ScheduledTaskRegistrar taskRegistrar);
    }
    ```
- 相关properties
    ```properties
    # TASK EXECUTION  (TaskExecutionProperties)
    spring.task.execution.pool.allow-core-thread-timeout=true # Whether core threads are allowed to time out. This enables dynamic growing and shrinking of the pool.
    spring.task.execution.pool.core-size=8 # Core number of threads.
    spring.task.execution.pool.keep-alive=60s # Time limit for which threads may remain idle before being terminated.
    spring.task.execution.pool.max-size= # Maximum allowed number of threads. If tasks are filling up the queue, the pool can expand up to that size to accommodate the load. Ignored if the queue is unbounded.
    spring.task.execution.pool.queue-capacity= # Queue capacity. An unbounded capacity does not increase the pool and therefore ignores the "max-size" property.
    spring.task.execution.thread-name-prefix=task- # Prefix to use for the names of newly created threads.

    # TASK SCHEDULING  (TaskSchedulingProperties)
    spring.task.scheduling.pool.size=1 # Maximum allowed number of threads.
    spring.task.scheduling.thread-name-prefix=scheduling- # Prefix to use for the names of newly created threads.
    ```