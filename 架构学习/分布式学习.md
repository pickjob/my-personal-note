# 分布式
- 分布式系统设计策略
    - 心跳检测
    - 高可用设计
        - 主备模式
        - 互备模式
        - 集群模式
    - 容错性
    - 负载均衡
        - 轮询(Round Robin)
        - 最少链接
        - IP地址哈希
        - 基于权重的负载均衡
- 实践
    - 全局ID生成
        - UUID
        - ID生成表
        - Snowflake
        - 结合缓存方案
    - 哈希取模
    - 一致性哈希
    - 路由表
    - 数据拆分
    - 容错
        - 自动重连
        - failover
            - Redistribute
            - Retry
            - Cancel
    - 序列化
    - 拆分
        - 水平拆封
            - 数据分布
                - hash映射
                - 范围映射
                - hash和范围映射
            - 请求路由
                - 只读的跨实例请求
                - 跨实例的原子读写请求
        - 主备复制
- ACID
    - Atomicity(原子性)
    - Consistency(一致性)
    - Isolation(隔离性)
- CAP定理: 对于一个分布式计算系统来说, 不可能同时满足以下三点
    - Consistency(一致性)
    - Availability(可用性)
    - Partition tolerance(分区容忍性)
- BASE: 
    - Basically availability(基本可用)
    - Soft state(软状态)
    - Eventually Consistent(最终一致性)
- 2PC/XA
    - 提交请求阶段/投票阶段(commit request phase)
    - 提交阶段(commit phase)
- 3PC
    - 询问阶段
    - 准备阶段
    - 提交阶段
- TCC(补偿事务)
    - Try
    - Confirm
    - Cancel
- Paxos
- Raft
    - 领导者
    - 选民
    - 候选人
- 高可用解决方案
    - 负载均衡
    - 系统拆分
        - 降级
        - 熔断
        - 流量控制
    - 缓存
    - MQ(削峰)
    - 分表分库 读写分离 (ES)
    - 异地多活
- 架构
    - SOA
        - 烟囱式架构(Information Silo Architecture)
        - 微内核架构(Microkernel Architecture)
        - 事件驱动架构(Event-Driven Architecture)
    - 微服务
        - 围绕业务能力构建(Organized around Business Capability)
        - 分散治理(Decentralized Governance)
        - 通过服务来实现独立自治的组件(Componentization via Services)
        - 产品化思维(Products not Projects)
        - 数据去中心化(Decentralized Data Management)
        - 强终端弱管道(Smart Endpoint and Dumb Pipe)
        - 容错性设计(Design for Failure)
        - 演进式设计(Evolutionary Design)
        - 基础设施自动化(Infrastructure Automation)
- 8 Fallacies of Distributed Computing
    - The network is reliable —— 网络是可靠的
    - Latency is zero —— 延迟是不存在的
    - Bandwidth is infinite —— 带宽是无限的
    - The network is secure —— 网络是安全的
    - Topology doesn't change —— 拓扑结构是一成不变的
    - There is one administrator —— 总会有一个管理员
    - Transport cost is zero —— 不必考虑传输成本
    - The network is homogeneous —— 网络是同质化的
- 分布式锁
    - 数据库锁
        - 数据库可用性
        - 无锁失效时间
        - 锁非阻塞
        - 锁不可重入
    - 缓存
        - 无锁失效时间
        - 锁非阻塞
        - 锁非可重入
    - zookeeper
- 架构重构12条军规(Uber)
    - 确定重构的目的和必要性
    - 定义“重构完成”的界限
    - 渐进式重构
    - 确定当前的架构状态
    - 不要忽略数据
    - 管理好技术债务
    - 远离那些虚荣的东西(例如使用“热门”的技术栈)
    - 做好准备面对压力
    - 了解业务
    - 做好面对非技术因素的准备
    - 对于代码质量有所掌握
    - 让团队做好准备