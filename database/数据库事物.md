# 数据库事物
- 数据库事物四大特性(ACID)
    - Atomicity (原子性)
    - Consistency (一致性)
    - Isolation (隔离性)
    - Durability (持久性)
- 隔离级别
    - READ UNCOMMITTED (读未提交)
    - READ COMMITTED (读已提交)
    - REPEATABLE READ (可重复读)
    - SERIALIZABLE (串行化)
- sql
    ```sql
    ---postgresql
    BEGIN;
    -- other operations
    SAVEPOINT sp1;
    INSERT INTO wines VALUES(’Chateau Lafite 2003’, ’24’);
    -- Assume the above fails because of a unique key violation,
    -- so now we issue these commands:
    ROLLBACK TO sp1;
    UPDATE wines SET stock = stock + 24 WHERE winename = ’Chateau Lafite 2003’;
    -- continue with other operations, and eventually
    COMMIT;
    ```
- spring
    - Spring管理事务
        - 编程式
            - TransactionTemplate
        - 声明式
            - 切面配置
            - @Transactional
    - Spring事务传播
        - Required : 如果当前存在一个逻辑事务，则加入该逻辑事务，否则将新建一个逻辑事务
        - RequiresNew : 每次都创建新的逻辑事务（物理事务也是不同的）
        - Supports : 当前存在逻辑事务，就加入到该逻辑事务，如果当前没有逻辑事务，就以非事务方式执行
        - NotSupported : 当前存在逻辑事务，就把当前事务暂停，以非事务方式执行
        - Mandatory : 必须有事务，否则抛出异常
        - Never : 当前存在是事务则抛出异常
        - Nested : 当前存在事务，则在嵌套事务内执行，如果当前不存在事务，则创建一个新的事务