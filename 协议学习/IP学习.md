# IP协议
- 分类
  - A类 : 0       网络号(7 bit)       主机号(24 bit)          1.0.0.0 - 127.255.255.255
  - B类 : 10      网络号(14 bit)      主机号(16 bit)          128.0.0.0 - 191.255.255.255
  - C类 : 110     网络号(21 bit)      主机号(8 bit)           192.0.0.0 - 223.255.255.255
  - D类 : 1110    网络号(28 bit)      主机号                  224.0.0.0 - 239.255.255.255
  - E类 : 11110   保留                                      240.0.0.0 - 247.255.255.255
  - 特殊IP地址
    - 0.0.0.0 : 本网络上的本主机
    - 1.1.1.1 : 本网络上广播地址
    - 网络号 主机号(1) : 网络号上所有主机广播地址
    - 127.0.0.1 : loopback test
  - 专用IP
    - A类 : 10
    - B类 : 172.16 - 172.31
    - C类 : 192.168.0 - 192.168.255
  - CIDR
    - <网络前缀>/<主机号>
- IPv4分组格式
  - 分组头
    - 版本(4 bit)
    - 分组长度(4 bit)
    - 服务类型(8 bit)
      - 优先级(2 bit)
      - D
      - T
      - R
      - C
      - -
    - O
    - DF
    - MF
    - 总长度(12 bit)
    - 标识（16 bit)
    - 标志
    - 段偏移
    - 生存时间(8 bit)
    - 协议(8 bit)
      - 1 : ICMP
      - 2 : IGMP
      - 6 : TCP
      - 8 : EGP
      - 17 : UDP
      - 31 : IPv6
      - 89 : OSPF
    - 头校验和(16 bit)
    - 源IP地址(32 bit)
    - 目的IP地址(32 bit)
    - 选项+填充(32 bit)
  - 数据
- ICMP
  - 报文类型
    - 差错报文
      - 目的站不可达
          - 类型(8 bit) : 3
          - 代码(8 bit) : 0 - 15
            - 0 : 网络不可达
            - 1 : 主机不可达
            - 2 : 协议不可达
            - 3 : 端口不可达
            - 4 : 需要分段,但DF置位使IP分组无法分段
            - 5 : 源路由失败
            - 6 : 目的网络位置
            - 7 : 目的主机未知
            - 8 : 源主机被隔离
            - 9 : 与目的网络通信被禁止
            - 10 : 与目的主机通信被禁止
            - 11 : 特定Tos网络不可达
            - 12 : 特定Tos主机不可达
            - 13 : 设置过滤是主机不可达
            - 14 : 非法优先级是主机不可达
            - 15 : 报文优先级低于网络设置最小优先级是主机不可达
      - 路由重定向
          - 类型(8 bit) : 4
          - 代码(8 bit) : 0 - 3
            - 0 : 特定网络重定向
            - 1 : 特定主机重定向
            - 2 : 基于指定服务类型对特定网络重定向
            - 3 : 基于指定服务类型对特定主机重定向
    - 查询报文
      - 时间戳请求与应答(13/14)
      - 回应请求与应答(8/0)
      - 地址掩码(17/18)
      - 路由器询问与通告(10/9)
  - 报文格式
      - 类型(8 bit)
      - 代码(8 bit)
      - 校验和(16 bit)
      - 其他部分(32 bit)
      - 数据(变长)
- ARP
    - 分组格式
      - 硬件类型(16 bit)
      - 协议类型(16 bit)
      - 硬件地址长度(8 bit)
      - 协议地址长度(8 bit)
      - 操作(16 bit)
      - 源MAC地址(48 bit)
      - 源IP地址(16 bit)
      - 目的MAC(48 bit)
      - 目的IP地址(16 bit)
      - 数据填充(22 byte)
- IPv6(128 bit)
  - 冒分十六进制表示(8段 16bit)
  - 0位压缩
  - 分类
    - ::/128 : 为定义
    - ：：1/128 : loopback
    - FF00::/8 : 组播地址
    - FE80::/10 : 链路本地地址
    - FEC0::/10 : 站点本地地址
    - 其他 : 全球单薄地址
      - ::FF:0:0/96 IPv4映射
      - 64:FF9B::/96 qianru IPv4的IPv6地址
  - 分组头部格式
    - 版本号(4 bit) : 6
    - 流量等级(8 bit) : QoS
    - 刘标签(20 bit)
    - 载荷长度(16 bit)
    - 下一个报头(8 bit)
    - 跳数限制(8 bit)
    - 源地址(128 bit)
    - 目的地址(128 bit)